select * from SFT010 where FT_NFISCAL = '000004903';

CHAVE: 35120208515495000101550020000049031006666816

-- Nota Fiscal 236
select D1_FORNECE, D1_DTDIGIT, * from SD1010 where D1_DOC = '000000236' and D1_FORNECE = '001631'
   and D_E_L_E_T_ = ' ';

select * from SF3010 where F3_NFISCAL = '000000236';

select FT_CODBCC, * from SFT010 where FT_NFISCAL = '000000236';

-- Nota Martim Bianco
update SF3010 set F3_ENTRADA = '20120229' where F3_NFISCAL = '000000400';
update SFT010 set FT_ENTRADA = '20120229' where FT_NFISCAL = '000000400';

SELECT * FROM AFR010 WHERE R_E_C_N_O_ = 53
 ORDER BY R_E_C_N_O_
 
-- 
select FT_ESPECIE, * from SFT010 WHERE FT_NFISCAL IN ('000032729', '000032928', '000033076')

SELECT SFT.FT_FILIAL,SFT.FT_TIPOMOV,SFT.FT_SERIE,SFT.FT_NFISCAL,SFT.FT_CLIEFOR,SFT.FT_LOJA,SFT.FT_ITEM,SFT.FT_PRODUTO,
	   SFT.FT_ENTRADA,SFT.FT_NRLIVRO,SFT.FT_CFOP,SFT.FT_ESPECIE,SFT.FT_TIPO,SFT.FT_EMISSAO,SFT.FT_DTCANC,SFT.FT_FORMUL,
	   SFT.FT_ALIQPIS,SFT.FT_VALPIS,SFT.FT_ALIQCOF,SFT.FT_VALCOF,SFT.FT_VALCONT,SFT.FT_BASEICM,SFT.FT_VALICM,SFT.FT_ISSST,
	   SFT.FT_BASERET,SFT.FT_ICMSRET,SFT.FT_VALIPI,SFT.FT_ISENICM,SFT.FT_QUANT,SFT.FT_DESCONT,SFT.FT_TOTAL,SFT.FT_FRETE,
	   SFT.FT_SEGURO,SFT.FT_DESPESA,SFT.FT_OUTRICM,SFT.FT_BASEIPI,SFT.FT_ISENIPI,SFT.FT_OUTRIPI,SFT.FT_ICMSCOM,SFT.FT_RECISS,
	   SFT.FT_BASEIRR,SFT.FT_ALIQICM,SFT.FT_ALIQIPI,SFT.FT_CTIPI,SFT.FT_POSIPI,SFT.FT_CLASFIS,SFT.FT_PRCUNIT,SFT.FT_CFPS,
	   SFT.FT_ESTADO,SFT.FT_CODISS,SFT.FT_ALIQIRR,SFT.FT_VALIRR,SFT.FT_BASEINS,SFT.FT_VALINS,SFT.FT_PDV,SFT.FT_ISSSUB,SFT.FT_CREDST,
	   SFT.FT_ISENRET,SFT.FT_OUTRRET,SFT.FT_CONTA,SFT.FT_BASEPIS,SFT.FT_BASECOF,SFT.FT_VALPS3,SFT.FT_VALCF3,SFT.FT_PESO,
	   SFT.FT_SOLTRIB,SFT.FT_CHVNFE, SFT.FT_CSTPIS,SFT.FT_CSTCOF,SFT.FT_INDNTFR, SFT.FT_CODBCC
  FROM SFT010 SFT 
 WHERE SFT.FT_FILIAL= '01' AND SFT.FT_ENTRADA>='20120201' AND SFT.FT_ENTRADA<='20120229' 
   AND ((SFT.FT_CFOP NOT LIKE '000%' AND SFT.FT_CFOP NOT LIKE '999%') OR SFT.FT_TIPO='S') 
   AND (SFT.FT_BASEPIS > 0 OR SFT.FT_BASECOF > 0) AND SFT.FT_ESPECIE <> 'CF' AND SFT.D_E_L_E_T_ = ' '
   AND SFT.FT_NFISCAL = '000004970'
 ORDER BY 1,2,3,4,5,6,7,8;
 
SELECT SFT.FT_FILIAL,SFT.FT_TIPOMOV,SFT.FT_SERIE,SFT.FT_NFISCAL,SFT.FT_CLIEFOR,SFT.FT_LOJA,SFT.FT_ITEM,SFT.FT_PRODUTO,SFT.FT_ENTRADA,SFT.FT_NRLIVRO,SFT.FT_CFOP,SFT.FT_ESPECIE,SFT.FT_TIPO,SFT.FT_EMISSAO,SFT.FT_DTCANC,SFT.FT_FORMUL,SFT.FT_ALIQPIS,SFT.FT_VALPIS,SFT.FT_ALIQCOF,SFT.FT_VALCOF,SFT.FT_VALCONT,SFT.FT_BASEICM,SFT.FT_VALICM,SFT.FT_ISSST,SFT.FT_BASERET,SFT.FT_ICMSRET,SFT.FT_VALIPI,SFT.FT_ISENICM,SFT.FT_QUANT,SFT.FT_DESCONT,SFT.FT_TOTAL,SFT.FT_FRETE,SFT.FT_SEGURO,SFT.FT_DESPESA,SFT.FT_OUTRICM,SFT.FT_BASEIPI,SFT.FT_ISENIPI,SFT.FT_OUTRIPI,SFT.FT_ICMSCOM,SFT.FT_RECISS,SFT.FT_BASEIRR,SFT.FT_ALIQICM,SFT.FT_ALIQIPI,SFT.FT_CTIPI,SFT.FT_POSIPI,SFT.FT_CLASFIS,SFT.FT_PRCUNIT,SFT.FT_CFPS,SFT.FT_ESTADO,SFT.FT_CODISS,SFT.FT_ALIQIRR,SFT.FT_VALIRR,SFT.FT_BASEINS,SFT.FT_VALINS,SFT.FT_PDV,SFT.FT_ISSSUB,SFT.FT_CREDST,SFT.FT_ISENRET,SFT.FT_OUTRRET,SFT.FT_CONTA,SFT.FT_BASEPIS,SFT.FT_BASECOF,SFT.FT_VALPS3,SFT.FT_VALCF3,SFT.FT_PESO,SFT.FT_SOLTRIB,SFT.FT_CHVNFE,SFT.FT_CSTPIS,SFT.FT_CSTCOF,SFT.FT_INDNTFR,SFT.FT_CODBCC,SFT.FT_RGESPST,SFT.FT_PAUTPIS,SFT.FT_PAUTCOF,SFT.FT_TNATREC,SFT.FT_CNATREC,SFT.FT_GRUPONC,SFT.FT_DTFIMNT 
  FROM SFT010 SFT 
 WHERE SFT.FT_FILIAL= '01' AND SFT.FT_ENTRADA>= '20120201' AND SFT.FT_ENTRADA<= '20120229' 
   AND ((SFT.FT_CFOP NOT LIKE '000%' AND SFT.FT_CFOP NOT LIKE '999%') OR SFT.FT_TIPO='S') 
   AND (SFT.FT_BASEPIS > 0 OR SFT.FT_BASECOF > 0 ) AND SFT.FT_ESPECIE <> 'CF' AND SFT.FT_NRLIVRO = ' ' AND SFT.FT_NFISCAL = '000004970' AND SFT.D_E_L_E_T_= ' ' 
 ORDER BY 1,2,3,4,5,6,7,8; 
 
-- 000004970
select F3_TIPO, * from SF3010 where F3_NFISCAL = '000004970'; 
select * from SFT010 where FT_NFISCAL = '000004970'; 

-- Notas com devolução
select FT_ITEM, * from SFT010 
 where FT_ENTRADA between '20120201' and '20120229' and FT_TIPO = 'D'
 order by FT_NFISCAL;
 
-- Ajusta o tipo
update SF3010 set F3_TIPO = 'D' where F3_NFISCAL = '000004970'; 
update SFT010 set FT_TIPO = 'D' where FT_NFISCAL = '000004970'; 

 select FT_ITEM, * from SFT010 
 where FT_ENTRADA between '20120201' and '20120229' and FT_NFISCAL = '000004970' and FT_ITEM = '01';
 
 select FT_RGESPST, FT_ITEM, * from SFT010 
 where FT_ENTRADA between '20120201' and '20120229'
 order by FT_NFISCAL;
 
 select FT_ITEM, * from SFT010 
 where FT_ENTRADA between '20120201' and '20120229' and FT_NFISCAL = '000000239' and D_E_L_E_T_ = ' '
 order by FT_NFISCAL, FT_ITEM;

 select SUM(FT_BASEPIS) as ft_basepis, SUM(FT_BASECOF) as ft_basecof,
        SUM(FT_VALPIS) as ft_valpis, SUM(FT_VALCOF) as ft_valcof
   from SFT010 
 where FT_ENTRADA between '20120201' and '20120229' and FT_NFISCAL = '000000239' and D_E_L_E_T_ = ' ';

 select FT_ESPECIE, FT_ITEM, * from SFT010 
 where FT_ENTRADA between '20120201' and '20120229' and FT_NFISCAL = '000000239' and D_E_L_E_T_ = ' '
 order by FT_NFISCAL, FT_ITEM;

update SFT010 set FT_ESPECIE = 'NFE'
 where FT_ENTRADA between '20120201' and '20120229' and FT_NFISCAL = '000000239' and D_E_L_E_T_ = ' ';

-- Campos da devolução
 select R_E_C_N_O_, FT_NFORI, FT_SERORI, FT_ITEMORI,  FT_CSTPIS, FT_ESPECIE, FT_ITEM, * from SFT010 
 where FT_ENTRADA between '20120201' and '20120229' and FT_NFISCAL = '000004970' and D_E_L_E_T_ = ' '
 order by FT_NFISCAL, FT_ITEM;
 
-- FT_NFORI: 000000239, FT_SERORI: 1 e FT_ITEMORI: 0002
update SFT010
   set FT_NFORI = '000000239', FT_SERORI = '1', FT_ITEMORI = '0002' 
 where R_E_C_N_O_ = 43755;

-- FT_ITEMORI: 0006
update SFT010
   set FT_NFORI = '000000239', FT_SERORI = '1', FT_ITEMORI = '0006' 
 where R_E_C_N_O_ = 43756;
 
-- Compra e Devolução
 select R_E_C_N_O_, FT_RGESPST, * from SFT010 
 where FT_ENTRADA between '20120201' and '20120229' and FT_NFISCAL in ('000004970', '000000239') and D_E_L_E_T_ = ' '
 order by FT_NFISCAL, FT_ITEM;
 
SELECT * FROM SF3010 where F3_NFISCAL = '000004970';
 
update SFT010
   set FT_CODBCC = '  '
 where FT_NFISCAL = '000004970';
 
select FT_ENTRADA, FT_CSTPIS, FT_BASEPIS, * from SFT010 
 where R_E_C_N_O_ between 43700 and 43780 and FT_ENTRADA between '20120101' and '20120229'  and FT_CFOP >= '5000'
   AND FT_NFISCAL in ('000004965', '000004966', '000004970')
 order by R_E_C_N_O_;
 
-- Altera CFOP 5201
update SFT010
   set FT_CFOP = '5201'
 where FT_NFISCAL = '000004970';
 
 select FT_ESPECIE, * from SFT010 where FT_NFISCAL in ('000032729', '000032928', '000033076')

select FT_ENTRADA, FT_ESPECIE, FT_SERIE, FT_CFOP, * from SFT010 where FT_NFISCAL = '000032729';

-- 09 e 1653
update SF3010 set F3_SERIE = '09', F3_CFO = '1653'
where F3_NFISCAL = '000032729';
update SFT010 set FT_SERIE = '09', FT_CFOP = '1653'
where FT_NFISCAL = '000032729';

select F1_BASIMP5, F1_VALIMP5, * from SF1010 WHERE F1_DOC = '000032729';
select D1_TES, * from SD1010 WHERE D1_DOC = '000032729';

select FT_ESPECIE, * from SFT010 WHERE FT_NFISCAL = '000032729';

SELECT F4_TPREG, * FROM SF4010 WHERE F4_CODIGO = '184';

SELECT F3_OBSERV, * FROM SF3010 WHERE F3_OBSERV LIKE '%DIF%'

select FT_CSTPIS, FT_CSTCOF, FT_ESPECIE, * from SFT010 where FT_NFISCAL in ('000032729', '000032928', '000033076');

UPDATE SFT010 
  SET FT_CSTPIS = '50', FT_CSTCOF = '50', FT_CODBCC = ''
 where FT_NFISCAL in ('000032729', '000032928', '000033076');