INSERT INTO F0M220(F0M_FILIAL, F0M_REGRA, F0M_SITUA, F0M_DTFECH, F0M_CODIGO, F0M_CST, F0M_QUANT, F0M_VALCMD, F0M_UM, F0M_VUNIT, R_E_C_N_O_)
SELECT B9_FILIAL AS F0M_FILIAL, '1' AS F0M_REGRA, '0' AS F0M_SITUA, B9_DATA AS F0M_DTFECH, B9_COD AS F0M_CODIGO, '040' AS F0M_CST,
       B9_QINI AS F0M_QUANT, B9_VINI1 AS F0M_VALCMD, B1_UM AS F0M_UM, B9_VINI1 / B9_QINI AS F0M_VUNIT,
	   (SELECT MAX(R_E_C_N_O_) FROM F0M220) + ROW_NUMBER() OVER(ORDER BY B9_COD)
  FROM SB9220 SB9
  JOIN SB1220 SB1 ON B1_FILIAL = B9_FILIAL AND B9_COD = B1_COD AND SB1.D_E_L_E_T_ = ' '
 WHERE B9_FILIAL = '01' AND B9_DATA = '20171231' AND B9_QINI > 0 AND SB9.D_E_L_E_T_ = ' '
 ORDER BY B9_COD
 
INSERT INTO F0M220(F0M_FILIAL, F0M_REGRA, F0M_SITUA, F0M_DTFECH, F0M_CODIGO, F0M_CST, F0M_QUANT, F0M_VALCMD, F0M_UM, F0M_VUNIT, R_E_C_N_O_)
SELECT DQ_FILIAL AS F0M_FILIAL, '1' AS F0M_REGRA, '0' AS F0M_SITUA, DQ_DATA AS F0M_DTFECH, DQ_COD AS F0M_CODIGO, '040' AS F0M_CST,
       DQ_XQTD AS F0M_QUANT, ROUND(DQ_CM1 * DQ_XQTD, 2) AS F0M_VALCMD, B1_UM AS F0M_UM, DQ_CM1 AS F0M_VUNIT,
	   (SELECT MAX(R_E_C_N_O_) FROM F0M220) + ROW_NUMBER() OVER(ORDER BY DQ_COD)
  FROM SDQ220 SDQ
  JOIN SB1220 SB1 ON B1_FILIAL = DQ_FILIAL AND DQ_COD = B1_COD AND SB1.D_E_L_E_T_ = ' '
 WHERE DQ_FILIAL = '02' AND DQ_DATA = '20171231' AND DQ_XQTD > 0 AND SDQ.D_E_L_E_T_ = ' '
 ORDER BY DQ_COD 