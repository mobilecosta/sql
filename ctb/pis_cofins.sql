SELECT D1_DOC, D1_ALQIMP5, D1_VALCMAJ, * FROM SD1010 WHERE D_E_L_E_T_ = ' ' AND D1_ALQIMP5 > 7.6 AND D1_VALCMAJ = 0
 ORDER BY D1_DOC;

SELECT F1_DTLANC, * FROM SF1010
  WHERE D_E_L_E_T_ = ' ' AND F1_DOC + F1_SERIE + F1_FORNECE + F1_LOJA
IN
(  
SELECT D1_DOC + D1_SERIE + D1_FORNECE + D1_LOJA
  FROM SD1010 WHERE D_E_L_E_T_ = ' ' AND D1_ALQIMP6 > 1.65
-- ORDER BY D1_DOC, D1_SERIE, D1_FORNECE, D1_LOJA;
)
 ORDER BY F1_DTLANC;

112518              	1461,18	0001 COFINS REF. NF 2  /000008022 DE YAS
112516              	317,23	0001 PIS REF. NF 2  /000008022 DE YASKAW
112518              	101,39	0002 COFINS REF. NF 2  /000008022 DE YAS
112516              	22,01	0002 PIS REF. NF 2  /000008022 DE YASKAW
112518              	460,02	0003 COFINS REF. NF 2  /000008022 DE YAS
112516              	99,87	0003 PIS REF. NF 2  /000008022 DE YASKAW
112518              	1753,02	0004 COFINS REF. NF 2  /000008022 DE YAS
112516              	380,59	0004 PIS REF. NF 2  /000008022 DE YASKAW
112518              	247,38	0005 COFINS REF. NF 2  /000008022 DE YAS
112516              	53,71	0005 PIS REF. NF 2  /000008022 DE YASKAW
112518              	1797,05	0006 COFINS REF. NF 2  /000008022 DE YAS
112516              	390,15	0006 PIS REF. NF 2  /000008022 DE YASKAW

-- Recalcula os valores
SELECT SUM(VALPIS) AS VALPIS, SUM(VALPIS_R) AS VALPIS_R, 
       SUM(VALPIS) - SUM(VALPIS_R) AS DIF_PIS, 
       SUM(VALCOF) AS VALCOF, SUM(VALCOF_R) AS VALCOF_R,
       SUM(VALCOF) - SUM(VALCOF_R) AS DIF_COF
  FROM
(  
SELECT D1_DOC, D1_ITEM, D1_BASIMP6 AS BASEPIS, D1_ALQIMP6, D1_VALIMP6 AS VALPIS, 
       D1_BASIMP5 AS BASECOF, D1_ALQIMP5, D1_VALIMP5 AS VALCOF, 
       ROUND(D1_BASIMP6 * 1.65 / 100, 2) AS VALPIS_R,
       ROUND(D1_BASIMP6 * 7.60 / 100, 2) AS VALCOF_R,
       D1_ALQIMP5 - 7.60 AS FT_MALQCOF, ROUND(D1_BASIMP5 * (D1_ALQIMP5 - 7.60) / 100, 2) AS FT_MVALCOF
  FROM SD1010 
 WHERE D_E_L_E_T_ = ' ' AND D1_DOC = '000008022'
-- ORDER BY D1_ITEM
) TAB; 

832,42

1524,27

SELECT F1_DTLANC, F1_DTDIGIT, F1_EMISSAO, F1_BASIMP5 AS BASECOF, F1_VALIMP5 AS VALCOF, 
       F1_BASIMP6 AS BASEPIS, F1_VALIMP6 AS VALPIS, F1_VALICM, F1_HAWB, F1_FOB_R, * 
  FROM SF1010 WHERE F1_DOC = '000008022';
  
UPDATE SF1010 SET F1_DTLANC = '' WHERE F1_DOC = '000008022';
 
SELECT * FROM CT2010 WHERE D_E_L_E_T_ = ' ' AND CT2_HIST LIKE '%000008022%'
 ORDER BY CT2_LINHA;

SELECT D1_BASIMP5, D1_ALQIMP5, D1_VALIMP5, ROUND(D1_BASIMP5 * (7.6 / 100), 2) AS NOVA, D1_DOC, D1_SERIE, D1_FORNECE, D1_LOJA 
  FROM SD1010 WHERE D_E_L_E_T_ = ' ' AND D1_ALQIMP5 > 7.60
 ORDER BY D1_DOC, D1_SERIE, D1_FORNECE, D1_LOJA

SELECT CT2_LOTE, CT2_DOC, CT2_HIST, SUM(CASE WHEN CT2_DC = '1' THEN CT2_VALOR ELSE 0 END) AS CREDITO,
       SUM(CASE WHEN CT2_DC = '2' THEN CT2_VALOR ELSE 0 END) AS DEBITO
  FROM CT2010 
 WHERE D_E_L_E_T_ = ' ' AND CT2_HIST LIKE '%000008022%'
 GROUP BY CT2_LOTE, CT2_DOC, CT2_HIST
 ORDER BY CT2_LOTE, CT2_DOC, CT2_HIST; 

cofins = 659,43
pis = 172,99

-- Totalizado
SELECT CTK_LOTE, CTK_HIST, SUM(CASE WHEN CTK_DC = '1' THEN CTK_VLR01 ELSE 0 END) AS CREDITO,
       SUM(CASE WHEN CTK_DC = '2' THEN CTK_VLR01 ELSE 0 END) AS DEBITO
  FROM CTK010 
 WHERE D_E_L_E_T_ = ' ' AND CTK_HIST LIKE '%000008022%'
 GROUP BY CTK_LOTE, CTK_HIST
 ORDER BY CTK_LOTE, CTK_HIST;
 
SELECT *
  FROM CTK010 
 WHERE D_E_L_E_T_ = ' ' AND CTK_SEQUEN = '0000038852'
   AND CTK_DC IN ('1', '2')

SELECT * FROM CT2010 
 WHERE D_E_L_E_T_ = ' ' AND CT2_DATA = '20130502' AND CT2_LOTE = '008810' AND CT2_DOC = '000002' AND CT2_DC IN ('1', '2')
 ORDER BY CT2_LINHA;

SELECT * FROM CT5010 
 WHERE D_E_L_E_T_ = ' ' AND CT5_FILIAL = '01' 
   AND CT5_LANPAD = '660'
-- AND CT5_LANPAD + '-' + CT5_SEQUEN IN ('650-003', '650-008', '650-009', '650-015', '650-016', '650-017', '650-018', '660-003')
 ORDER BY CT5_LANPAD + '-' + CT5_SEQUEN
 
SELECT 1263.56 + 5820.04 + 8615.8

SELECT 1436.55 + 7171.32 + 8615.8

SELECT SUM(WN_VLRPIS) AS WN_VLRPIS, SUM(WN_VLRCOF) AS WN_VLRCOF, SUM(WN_IIVAL+WN_DESPICM) AS IMPOSTO 
  FROM SWN010 WHERE D_E_L_E_T_ = ' ' AND WN_DOC = '000008022';
  
SELECT 5820.04 + 1263.56;

SELECT 6479.47 + 1436.55;

SELECT * FROM ZT8HTG.dbo.CT2010 WHERE D_E_L_E_T_ = ' ' AND CT2_HIST LIKE '%000007916%'
 ORDER BY CT2_LINHA;

SELECT F1_DTLANC, F1_DTDIGIT, F1_EMISSAO, F1_BASIMP5 AS BASECOF, F1_VALIMP5 AS VALCOF, 
       F1_BASIMP6 AS BASEPIS, F1_VALIMP6 AS VALPIS, F1_VALICM, F1_HAWB, F1_FOB_R, * 
  FROM SF1010 WHERE F1_DOC = '000007916';
  
UPDATE SF1010 SET F1_DTLANC = '' WHERE F1_DOC = '000007916';

SELECT SUM(CASE WHEN CT2_DC = '1' THEN CT2_VALOR ELSE 0 END) AS CREDITO,
       SUM(CASE WHEN CT2_DC = '2' THEN CT2_VALOR ELSE 0 END) AS DEBITO
  FROM CT2010 
 WHERE D_E_L_E_T_ = ' ' AND CT2_HIST LIKE '%000007916%'; 

1524.27

7916,02

7083,6