-- Correção 1
select D1_IDENTB6, * from SD1010 WHERE D_E_L_E_T_ = ' ' AND D1_TES = '193' 
   AND D1_COD IN ('CHAPAS DE ACO', '2122.0PI','2283.0PI', '3197.0PI', '3299.0PI')
 ORDER BY D1_COD;
 
SELECT F4_PODER3, * FROM SF4010 WHERE F4_CODIGO = '193';

update SD1010 
   set D1_TES = '393'
 WHERE D_E_L_E_T_ = ' ' AND D1_TES = '193' 
   AND D1_COD IN ('CHAPAS DE ACO', '2122.0PI','2283.0PI', '3197.0PI', '3299.0PI');

-- Correção 2
SELECT F4_PODER3, * FROM SF4010 WHERE F4_CODIGO = '191';

select D1_NFORI, D1_IDENTB6, * from SD1010 WHERE D_E_L_E_T_ = ' ' AND D1_TES = '191' 
   AND D1_COD = '411'
 ORDER BY D1_COD;
 
update SD1010 
   set D1_TES = '391'
 WHERE D_E_L_E_T_ = ' ' AND D1_TES = '191' 
   AND D1_COD = '411';
 
-- Correção 3
SELECT F4_PODER3, * FROM SF4010 WHERE F4_CODIGO = '778';

SELECT D2_NFORI, D2_ITEMORI, * FROM SD2010 WHERE D2_TES = '778' AND D2_COD = '5001002350008';

UPDATE SD2010 SET D2_TES = '878' WHERE D2_TES = '778' AND D2_COD = '5001002350008';

-- Correção 4
SELECT D2_DOC, D2_NFORI, D2_SERIORI, D2_ITEMORI, D2_CLIENTE, D2_LOJA, D2_SERIE, * 
  FROM SD2010
 WHERE D_E_L_E_T_ = ' ' AND D2_FILIAL = '01' AND D2_DOC IN ('000003536','000003623')
 ORDER BY D2_DOC, D2_COD;
 
SELECT D1_ITEM, D1_SERIE, * FROM SD1010
 WHERE D_E_L_E_T_ = ' ' AND D1_FILIAL = '01' AND D1_DOC = '000000032' 
   AND D1_FORNECE = '002244' AND D1_LOJA = '01' 
   AND D1_COD IN ('00485', '00487', '00489', '00490', '00492', '00500', '00521')
 ORDER BY D1_ITEM; 

UPDATE SD2010
   SET D2_NFORI = '000000032', D2_SERIORI = '13', D2_ITEMORI = '0002'
 WHERE D_E_L_E_T_ = ' ' AND D2_FILIAL = '01' AND D2_DOC = '000003536' AND D2_COD = '00485';

UPDATE SD2010
   SET D2_NFORI = '000000032', D2_SERIORI = '13', D2_ITEMORI = '0003'
 WHERE D_E_L_E_T_ = ' ' AND D2_FILIAL = '01' AND D2_DOC = '000003536' AND D2_COD = '00487';

UPDATE SD2010
   SET D2_NFORI = '000000032', D2_SERIORI = '13', D2_ITEMORI = '0005'
 WHERE D_E_L_E_T_ = ' ' AND D2_FILIAL = '01' AND D2_DOC = '000003536' AND D2_COD = '00489';

UPDATE SD2010
   SET D2_NFORI = '000000032', D2_SERIORI = '13', D2_ITEMORI = '0006'
 WHERE D_E_L_E_T_ = ' ' AND D2_FILIAL = '01' AND D2_DOC = '000003536' AND D2_COD = '00490';

UPDATE SD2010
   SET D2_NFORI = '000000032', D2_SERIORI = '13', D2_ITEMORI = '0008'
 WHERE D_E_L_E_T_ = ' ' AND D2_FILIAL = '01' AND D2_DOC = '000003536' AND D2_COD = '00492';

UPDATE SD2010
   SET D2_NFORI = '000000032', D2_SERIORI = '13', D2_ITEMORI = '0013'
 WHERE D_E_L_E_T_ = ' ' AND D2_FILIAL = '01' AND D2_DOC = '000003536' AND D2_COD = '00500';

UPDATE SD2010
   SET D2_NFORI = '000000032', D2_SERIORI = '13', D2_ITEMORI = '0026'
 WHERE D_E_L_E_T_ = ' ' AND D2_FILIAL = '01' AND D2_DOC = '000003623' AND D2_COD = '00521';

-- Corrige IdentB6
 UPDATE SD2010
   SET D2_IDENTB6 = SD1.D1_IDENTB6
  FROM (
  SELECT SD1.D1_IDENTB6, SD2.R_E_C_N_O_
  FROM SD2010 SD2
  JOIN SD1010 SD1 ON SD1.D1_FILIAL = SD2.D2_FILIAL AND SD1.D1_DOC = SD2.D2_NFORI 
   AND SD1.D1_SERIE = SD2.D2_SERIORI AND SD1.D1_FORNECE = SD2.D2_CLIENTE AND SD1.D1_LOJA = SD2.D2_LOJA
   AND SD1.D1_ITEM = SD2.D2_ITEMORI AND SD1.D1_IDENTB6 <> ''
  JOIN SF4010 SF4 ON SF4.F4_FILIAL = '01' AND SF4.D_E_L_E_T_ = ' ' AND SF4.F4_CODIGO = SD2.D2_TES 
   AND SF4.F4_PODER3 IN ('R', 'D')
 WHERE SD2.D2_FILIAL = '01' AND SD2.D2_IDENTB6 = '' AND SD2.D2_NFORI <> ''  AND SD2.D2_ITEMORI <> ''
) SD1
 WHERE SD2010.R_E_C_N_O_ = SD1.R_E_C_N_O_;   

SELECT * FROM SB6010 WHERE B6_DOC = '000000032';

-- PRODUTO 489
SELECT B6_IDENT, * FROM SB6010 WHERE B6_PRODUTO = '00489' ORDER BY R_E_C_N_O_;

SELECT * FROM SD2010 WHERE D_E_L_E_T_ = ' ' AND D2_DOC = '000005252' AND D2_COD = '00489';

SELECT D2_DOC, D2_EMISSAO, D2_QUANT, * FROM SD2010 WHERE D2_IDENTB6 = '142751' AND D2_COD = '00489';
SELECT D1_DOC, * FROM SD1010 WHERE D1_IDENTB6 = '142751' AND D1_COD = '00489';
 
-- 20/04/2012
SELECT D1_DOC, D1_SERIE, D1_TES, * FROM SD1010 
 WHERE D_E_L_E_T_ = ' ' AND D1_COD = 'NOMA02' AND D1_QUANT > 0;

SELECT D2_NFORI, D2_SERIORI, D2_ITEMORI, * 
  FROM SD2010 
 WHERE D_E_L_E_T_ = ' ' AND D2_COD = 'NOMA02' AND D2_QUANT > 0;
   
SELECT * FROM SB6010 WHERE D_E_L_E_T_ = ' ' AND B6_PRODUTO BETWEEN 'NOMA02' AND 'NOMA02'
 ORDER BY B6_PRODUTO, R_E_C_N_O_;

SELECT F4_PODER3, * FROM SF4010 WHERE F4_CODIGO = '186'; 

-- Correção da nota 000771 e 000772
SELECT SUM(D1_QUANT) AS D1_QUANT
  FROM
(
SELECT D1_DOC, D1_SERIE, D1_ITEM, D1_COD, D1_QUANT FROM SD1010 
 WHERE D_E_L_E_T_ = ' ' AND D1_DOC IN ('000771', '000772') AND D1_TES = '186'
   ORDER BY D1_DOC, D1_ITEM
) AS TAB

SELECT SUM(D2_QUANT) AS D2_QUANT
  FROM
(
SELECT D2_DOC, D2_SERIE, D2_COD, D2_NFORI, D2_SERIORI, D2_ITEMORI, D2_QUANT FROM SD2010 
 WHERE D_E_L_E_T_ = ' ' AND D2_DOC IN ('000710', '000711') AND D2_TES = '715'
-- ORDER BY D1_ITEM, D2_ITEM;
) AS TAB

-- Correção da nota 005508
SELECT SUM(D1_QUANT) AS D1_QUANT
  FROM
(
SELECT D1_DOC, D1_SERIE, D1_COD, D1_QUANT FROM SD1010 
 WHERE D_E_L_E_T_ = ' ' AND D1_DOC = '005508' AND D1_TES = '186'
-- ORDER BY D1_DOC, D1_ITEM
) AS TAB

SELECT SUM(D2_QUANT) AS D2_QUANT
  FROM
(
SELECT D2_DOC, D2_SERIE, D2_COD, D2_NFORI, D2_SERIORI, D2_ITEMORI, D2_QUANT FROM SD2010 
 WHERE D_E_L_E_T_ = ' ' AND D2_DOC = '001539' AND D2_TES = '715'
-- ORDER BY D1_ITEM, D2_ITEM;
) AS TAB

UPDATE SD2010 
   SET D2_NFORI = CASE WHEN D2_DOC = '000710' THEN '000771' ELSE '000772' END, D2_SERIORI = '2'       
 WHERE D_E_L_E_T_ = ' ' AND D2_DOC IN ('000710', '000711') AND D2_TES = '715';

-- Corrige IdentB6
 UPDATE SD2010
   SET D2_IDENTB6 = SD1.D1_IDENTB6
  FROM (
  SELECT SD2.D2_COD, SD1.D1_IDENTB6, SD2.R_E_C_N_O_
  FROM SD2010 SD2
  JOIN SD1010 SD1 ON SD1.D1_FILIAL = SD2.D2_FILIAL AND SD1.D1_DOC = SD2.D2_NFORI 
   AND SD1.D1_SERIE = SD2.D2_SERIORI AND SD1.D1_FORNECE = SD2.D2_CLIENTE AND SD1.D1_LOJA = SD2.D2_LOJA
   AND SD1.D1_COD = SD2.D2_COD AND SD1.D1_IDENTB6 <> ''
  JOIN SF4010 SF4 ON SF4.F4_FILIAL = '01' AND SF4.D_E_L_E_T_ = ' ' AND SF4.F4_CODIGO = SD2.D2_TES 
   AND SF4.F4_PODER3 IN ('R', 'D')
 WHERE SD2.D_E_L_E_T_ = ' ' AND SD2.D2_DOC IN ('000710', '000711') AND SD2.D2_TES = '715'
-- ORDER BY SD2.D2_DOC, SD2.D2_COD
) SD1
 WHERE SD2010.R_E_C_N_O_ = SD1.R_E_C_N_O_; 
 
SELECT D2_IDENTB6, D2_NFORI, D2_SERIORI, D2_ITEMORI, * 
  FROM SD2010
 WHERE D_E_L_E_T_ = ' ' AND D2_DOC IN ('000710', '000711') AND D2_TES = '715'
 ORDER BY D2_DOC, D2_ITEM;

--
SELECT D1_DOC, D1_SERIE, D1_TES, * FROM SD1010 
 WHERE D_E_L_E_T_ = ' ' AND D1_COD = 'NOMA60' AND D1_QUANT > 0;

SELECT D2_TES, D2_IDENTB6, D2_NFORI, D2_SERIORI, D2_ITEMORI, * 
  FROM SD2010 
 WHERE D_E_L_E_T_ = ' ' AND D2_COD = 'NOMA60' AND D2_QUANT > 0;
   
SELECT * FROM SB6010 
 WHERE D_E_L_E_T_ = ' ' AND B6_PRODUTO BETWEEN 'NOMA60' AND 'NOMA60'
 ORDER BY B6_PRODUTO, R_E_C_N_O_;

SELECT F4_PODER3, * FROM SF4010 WHERE F4_CODIGO IN ('186', '715');
