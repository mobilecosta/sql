-- Cadastro de Tes
SELECT CASE WHEN PWI.PWI_IDUSER IN ('000000','000105','000147','000178','000173') THEN 1 ELSE 0 END AS ACESSO, 
       SZT.ZT_NOME, PWA.PWA_DESCR, PWI.* 
  FROM PWI010 PWI
  JOIN SZT010 SZT ON SZT.D_E_L_E_T_ = ' ' AND SZT.ZT_FILIAL = '  ' AND SZT.ZT_IDUSER = PWI.PWI_IDUSER
  JOIN PWA010 PWA ON PWA.D_E_L_E_T_ = ' ' AND PWA.PWA_FILIAL = '  ' AND PWA.PWA_ID = PWI.PWI_IDTMPL 
 WHERE PWI.D_E_L_E_T_ = ' ' AND PWI.PWI_ROTINA = 'MATA080' 
   AND CASE WHEN PWI.PWI_IDUSER IN ('000000','000105','000147','000178','000173') THEN 1 ELSE 0 END = 1
 ORDER BY PWI.PWI_MODULO, PWI.PWI_IDUSER;

-- Movimentos Internos e Transferencias 
SELECT CASE WHEN PWI.PWI_IDUSER IN ('000000','000022','000119','000158','000159','000178','000173') THEN 1 ELSE 0 END AS ACESSO, * 
  FROM PWI010 PWI
 WHERE PWI.D_E_L_E_T_ = ' ' AND PWI.PWI_ROTINA in ('MATA240', 'MATA241', 'MATA260', 'MATA261')
   AND CASE WHEN PWI.PWI_IDUSER IN ('000000','000022','000119','000158','000159','000178','000173') THEN 1 ELSE 0 END = 1
 ORDER BY PWI.PWI_ROTINA, PWI.PWI_IDUSER, PWI.PWI_MODULO; 
 
-- Cadastro de Tes
SELECT * FROM SZT010 WHERE ZT_IDUSER IN ('000000','000105','000147','000178','000173')

SELECT CASE WHEN PWI.PWI_IDUSER IN ('000000','000105','000147','000178','000173') THEN 1 ELSE 0 END AS ACESSO,
       SZT.ZT_IDUSER, SZT.ZT_NOME, * FROM PWI010 PWI
  JOIN SZT010 SZT ON SZT.D_E_L_E_T_ = ' ' AND SZT.ZT_FILIAL = '  ' AND SZT.ZT_IDUSER = PWI.PWI_IDUSER
 WHERE PWI.D_E_L_E_T_ = ' ' AND PWI.PWI_ACES03 = 'S'
   AND PWI_ROTINA = 'MATA080';

-- Internos e Transferencias
SELECT * FROM SZT010 WHERE ZT_IDUSER IN ('000000','000022','000119','000158','000159','000178','000173');

-- Internos e Transferencias
SELECT CASE WHEN PWI.PWI_IDUSER IN ('000000','000022','000119','000158','000159','000178','000173') THEN 1 ELSE 0 END AS ACESSO,
       SZT.ZT_IDUSER, SZT.ZT_NOME, * FROM PWI010 PWI
  JOIN SZT010 SZT ON SZT.D_E_L_E_T_ = ' ' AND SZT.ZT_FILIAL = '  ' AND SZT.ZT_IDUSER = PWI.PWI_IDUSER
 WHERE PWI.D_E_L_E_T_ = ' ' AND PWI.PWI_ACES03 = 'S'
   AND PWI_ROTINA IN ('MATA240', 'MATA241', 'MATA260', 'MATA261');

-- 1. Tira o acesso de todas rotinas 
-- Templates
UPDATE PWF010 
   SET PWF_ACES03 = 'N', PWF_ACES04 = 'N', PWF_ACES05 = 'N', PWF_ACES06 = 'N', PWF_ACES07 = 'N', PWF_ACES08 = 'N',
       PWF_ACES09 = 'N', PWF_ACES10 = 'N', 
       PWF_ACES11 = 'N', PWF_ACES12 = 'N', PWF_ACES13 = 'N', PWF_ACES14 = 'N', PWF_ACES15 = 'N', 
       PWF_ACES16 = 'N', PWF_ACES17 = 'N', PWF_ACES18 = 'N', PWF_ACES19 = 'N', PWF_ACES20 = 'N'
 WHERE D_E_L_E_T_ = ' '
   AND PWF_ROTINA IN ('MATA080', 'MATA240', 'MATA241', 'MATA260', 'MATA261');

-- Usuários
UPDATE PWI010 
   SET PWI_ACES03 = 'N', PWI_ACES04 = 'N', PWI_ACES05 = 'N', PWI_ACES06 = 'N', PWI_ACES07 = 'N', PWI_ACES08 = 'N',
       PWI_ACES09 = 'N', PWI_ACES10 = 'N', 
       PWI_ACES11 = 'N', PWI_ACES12 = 'N', PWI_ACES13 = 'N', PWI_ACES14 = 'N', PWI_ACES15 = 'N', 
       PWI_ACES16 = 'N', PWI_ACES17 = 'N', PWI_ACES18 = 'N', PWI_ACES19 = 'N', PWI_ACES20 = 'N'
 WHERE D_E_L_E_T_ = ' '
   AND PWI_ROTINA IN ('MATA080', 'MATA240', 'MATA241', 'MATA260', 'MATA261');

-- 2. Coloca os acessos para os usuários definidos (MATA080)
UPDATE PWI010
   SET PWI_ACES03 = 'S', PWI_ACES04 = 'S', PWI_ACES05 = 'S', PWI_ACES06 = 'S', PWI_ACES07 = 'S', PWI_ACES08 = 'S',
       PWI_ACES09 = 'S', PWI_ACES10 = 'S', 
       PWI_ACES11 = 'S', PWI_ACES12 = 'S', PWI_ACES13 = 'S', PWI_ACES14 = 'S', PWI_ACES15 = 'S', 
       PWI_ACES16 = 'S', PWI_ACES17 = 'S', PWI_ACES18 = 'S', PWI_ACES19 = 'S', PWI_ACES20 = 'S'
 WHERE D_E_L_E_T_ = ' ' AND PWI_IDUSER IN ('000000','000105','000147','000178','000173')
   AND PWI_ROTINA = 'MATA080';

-- 3. Coloca os acessos para os usuários definidos (Internos ou Transferencias)
UPDATE PWI010
   SET PWI_ACES03 = 'S', PWI_ACES04 = 'S', PWI_ACES05 = 'S', PWI_ACES06 = 'S', PWI_ACES07 = 'S', PWI_ACES08 = 'S',
       PWI_ACES09 = 'S', PWI_ACES10 = 'S', 
       PWI_ACES11 = 'S', PWI_ACES12 = 'S', PWI_ACES13 = 'S', PWI_ACES14 = 'S', PWI_ACES15 = 'S', 
       PWI_ACES16 = 'S', PWI_ACES17 = 'S', PWI_ACES18 = 'S', PWI_ACES19 = 'S', PWI_ACES20 = 'S'
 WHERE D_E_L_E_T_ = ' ' AND PWI_IDUSER IN ('000000','000022','000119','000158','000159','000178','000173')
   AND PWI_ROTINA IN ('MATA240', 'MATA241', 'MATA260', 'MATA261');